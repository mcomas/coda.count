library(coda.count)
x = scan(text = "6  0 10  0  1 10  0  3")
mu = -16.1314
sigma = matrix(0.4439)
mu_prior = c(-2.79879403, 0.98025814, -0.06535460, 0.41110713,
             -0.75061216, -0.09082244, -0.87175059)
sigma_prior = matrix(scan(text = "1.000000e+00 -3.769167e-17  1.180615e-16 4.738515e-17  0.000000e+00  1.960557e-16  5.144815e-17
 -3.769167e-17  1.000000e+00  2.418318e-18 4.611290e-17  1.869792e-17  8.835997e-17  2.268812e-17
  1.180615e-16  2.418318e-18  1.000000e+00 1.826633e-17  4.442463e-17  6.447152e-17 -2.930234e-18
  4.738515e-17  4.611290e-17  1.826633e-17 1.000000e+00  4.041719e-17  5.073883e-17  2.775558e-17
  0.000000e+00  1.869792e-17  4.442463e-17 4.041719e-17  1.000000e+00  2.228115e-17 -1.448587e-17
  1.960557e-16  8.835997e-17  6.447152e-17 5.073883e-17  2.228115e-17  1.000000e+00 -3.936508e-17
 5.144815e-17  2.268812e-17 -2.930234e-18 2.775558e-17 -1.448587e-17 -3.936508e-17  1.000000e+00"), ncol = 7)
h2 = scan(text = "-17.4113300 -16.7598374 -16.7710568 -17.1146750  -0.2867071  -0.5826178")
B = matrix(scan(text = "-0.4564355  0.0000000  0.0000000  0.0000000  0.0000000  0.7071068  0.4082483
0.2738613  0.7071068  0.4082483  0.2886751  0.2236068  0.0000000  0.0000000
-0.4564355  0.0000000  0.0000000  0.0000000  0.0000000 -0.7071068  0.4082483
0.2738613 -0.7071068  0.4082483  0.2886751  0.2236068  0.0000000  0.0000000
0.2738613  0.0000000 -0.8164966  0.2886751  0.2236068  0.0000000  0.0000000
-0.4564355  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000 -0.8164966
0.2738613  0.0000000  0.0000000 -0.8660254  0.2236068  0.0000000  0.0000000
0.2738613  0.0000000  0.0000000  0.0000000 -0.8944272  0.0000000  0.0000000"), ncol = 7)
c_moments_lrnm_cond_hermite(x, mu, sigma, mu_prior, sigma_prior, h2, B, order = 5, mu_centering = 0)


library(mvtnorm)
I1 = 1
I2 = -1
dmvnorm(h2, mu_prior[I2], sigma_prior[I2,I2], log = TRUE)
inv_sigma_prior_2 = MASS::ginv(sigma_prior[I2,I2]);
Mc = mu_prior[I1] + sigma_prior[I1,I2] %*% inv_sigma_prior_2 %*% (h2-mu_prior[I2])
Sc = sigma_prior[I1,I1] - sigma_prior[I1,I2] %*% inv_sigma_prior_2 %*% sigma_prior[I2,I1]

